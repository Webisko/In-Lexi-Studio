RewriteEngine On
RewriteBase /

# 1. Passenger App Handling (Critical)
# Turn off RewriteEngine for /app so Passenger can take over via its own config
RewriteRule ^app - [L]

# 2. Astro Static Pages
# If request maps to a directory, check for index.html inside it
RewriteCond %{REQUEST_FILENAME} -d
RewriteCond %{REQUEST_FILENAME}/index.html -f
RewriteRule ^(.*)$ $1/index.html [L]

# 3. Standard Static Files
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# 4. Error Document (Optional - pretty 404)
# If nothing matches, let Apache serve its default 404 or your custom 404.html
ErrorDocument 404 /404.html
