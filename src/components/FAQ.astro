---
const faqs = [
  {
    question: 'What photography services do you offer?',
    answer:
      'I offer three main photography services: Weddings – Full wedding day coverage capturing candid moments and portraits from ceremony to reception. Portraits & Headshots – Professional headshots for business/LinkedIn and personal portrait sessions, in-studio or on location. Product & Promotional Photography – Commercial photography for businesses including product shots, e-commerce images, and marketing campaigns.',
  },
  {
    question: 'What is included in your photography services and what are your rates?',
    answer:
      'Each service includes consultation, professional editing, and high-resolution image delivery. Rates vary based on the specific package and duration of coverage. Please contact us for a detailed price list.',
  },
  {
    question:
      'How far in advance should I book my photography session and what is your booking process?',
    answer:
      'For weddings, we recommend booking 12-18 months in advance. For portrait sessions, 1-2 months is usually sufficient. Our process involves an initial consultation, signing a contract, and a deposit to secure your date.',
  },
  {
    question: 'Do you offer complimentary consultations?',
    answer:
      "Yes, we believe it's important to connect before the big day. We offer complimentary video or in-person consultations to discuss your vision.",
  },
  {
    question: 'What happens if I wait to book?',
    answer:
      'Dates are filled on a first-come, first-served basis. Waiting may result in your preferred date being unavailable.',
  },
  {
    question: 'Can you show me recent work from sessions like mine?',
    answer:
      "Absolutely. You can view our 'Latest Moments' section or request full gallery examples relevant to your specific event type.",
  },
  {
    question: 'What makes you different from other photographers?',
    answer:
      "Our focus is on raw emotion and storytelling. We don't just take pictures; we preserve the feeling of the moment, creating a legacy for you to cherish.",
  },
];
---

<section class="bg-off-white px-6 py-24 md:px-24">
  <div class="mx-auto max-w-4xl">
    <div class="mb-16 text-center">
      <p class="mb-4 font-sans text-xs uppercase tracking-[0.3em] text-gray-400">
        Questions & Answers
      </p>
      <h2 class="font-display text-4xl text-black md:text-5xl">Frequently Asked Questions</h2>
    </div>

    <div class="border-t border-gray-200" data-faq-accordion>
      {
        faqs.map((faq, index) => (
          <div class={`faq-item${index === 0 ? ' is-open' : ''}`}>
            <button
              type="button"
              class="faq-summary"
              aria-expanded={index === 0 ? 'true' : 'false'}
              aria-controls={`faq-panel-${index}`}
              id={`faq-summary-${index}`}
            >
              <h3 class="flex-1 pr-8 text-left font-sans text-xs uppercase leading-relaxed tracking-widest text-gray-800 md:text-sm">
                {faq.question}
              </h3>
              <span class="faq-icon faq-icon--plus" aria-hidden="true">
                +
              </span>
              <span class="faq-icon faq-icon--minus" aria-hidden="true">
                –
              </span>
            </button>

            <div
              class="faq-panel"
              id={`faq-panel-${index}`}
              role="region"
              aria-labelledby={`faq-summary-${index}`}
              hidden={index !== 0}
            >
              <div class="faq-content-inner">
                <p class="font-serif text-lg leading-relaxed text-gray-500">{faq.answer}</p>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<script>
  (() => {
    const root = document.querySelector('[data-faq-accordion]');
    if (!(root instanceof HTMLElement)) return;
    if (root.dataset.faqInit === 'true') return;
    root.dataset.faqInit = 'true';

    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const DURATION_MS = prefersReducedMotion ? 0 : 360;

    const items = Array.from(root.querySelectorAll('.faq-item'));

    const getPanel = (item) => item.querySelector('.faq-panel');
    const getButton = (item) => item.querySelector('.faq-summary');

    const setExpanded = (item, isOpen) => {
      const button = getButton(item);
      if (button) button.setAttribute('aria-expanded', String(isOpen));
      item.classList.toggle('is-open', isOpen);
    };

    const expandPanel = (panel) => {
      panel.hidden = false;
      panel.style.height = '0px';
      panel.style.opacity = '0';
      // Force reflow so the browser picks up the starting height.
      void panel.offsetHeight;

      const targetHeight = panel.scrollHeight;
      panel.style.transitionDuration = `${DURATION_MS}ms`;
      panel.style.height = `${targetHeight}px`;
      panel.style.opacity = '1';

      const onEnd = (event) => {
        if (event.target !== panel || event.propertyName !== 'height') return;
        panel.style.height = 'auto';
        panel.removeEventListener('transitionend', onEnd);
      };
      panel.addEventListener('transitionend', onEnd);
    };

    const collapsePanel = (panel) => {
      const currentHeight = panel.scrollHeight;
      panel.style.transitionDuration = `${DURATION_MS}ms`;
      panel.style.height = `${currentHeight}px`;
      panel.style.opacity = '1';
      void panel.offsetHeight;
      panel.style.height = '0px';
      panel.style.opacity = '0';

      const onEnd = (event) => {
        if (event.target !== panel || event.propertyName !== 'height') return;
        panel.hidden = true;
        panel.removeEventListener('transitionend', onEnd);
      };
      panel.addEventListener('transitionend', onEnd);
    };

    const closeItem = (item) => {
      const panel = getPanel(item);
      if (!panel || panel.hidden) {
        setExpanded(item, false);
        return;
      }
      setExpanded(item, false);
      collapsePanel(panel);
    };

    const openItem = (item) => {
      const panel = getPanel(item);
      if (!panel) return;
      setExpanded(item, true);
      expandPanel(panel);
    };

    items.forEach((item) => {
      const button = getButton(item);
      const panel = getPanel(item);
      if (!(button instanceof HTMLButtonElement) || !(panel instanceof HTMLElement)) return;

      // Normalize initial state so the first open item has height:auto.
      const isInitiallyOpen = item.classList.contains('is-open');
      setExpanded(item, isInitiallyOpen);
      if (isInitiallyOpen) {
        panel.hidden = false;
        panel.style.height = 'auto';
        panel.style.opacity = '1';
      } else {
        panel.hidden = true;
        panel.style.height = '0px';
        panel.style.opacity = '0';
      }

      button.addEventListener('click', () => {
        const isOpen = item.classList.contains('is-open');

        // Only one open at a time.
        items.forEach((other) => {
          if (other !== item) closeItem(other);
        });

        if (isOpen) {
          closeItem(item);
        } else {
          openItem(item);
        }
      });
    });
  })();
</script>
